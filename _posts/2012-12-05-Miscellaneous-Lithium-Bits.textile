---
layout: post
title: Miscellaneous Lithium (li3) bits and bobs
author: Gary Rafferty
meta_keywords: li3 lithium elements partials json
meta_description: Some miscellaneous bits and bobs for use with Lithium li3
---
h1. {{ page.title }}

p. 

In work, we recently started development on a new product to solve the problems with Facebook Promoted Posts, 
"PropelAd":http://propelad.com.

Before we started the actual dev, we were weighing up either sticking with our inhouse framework, or bringing
in something new. We evaluated the usual suspects of Symfony2, Zend, and CakePHP, but none of these frameworks
cut it for one reason or another. Long story short, we were pretty impressed with "Lithium":http://lithify.me, otherwise known as li3, 
and have been getting good results. 

My only issue with Lithium is the lack of resources, other than a handful of StackOverflow questions and the 
"manual":http://lithify.me/docs/manual. Though as usage increases, the amount of resources will too increase.
Here's some random things that took a few minutes to find out.

h3. Render an element to a view

Elements can simply be thought of as reusable view components. In the Rails world, we call them partials :)
In Lithium, you can render an element by storing it in app/views/elements/myelement.html.php and then calling
the element directly from the view.

{% highlight php %}

<?php echo $this->_render('element','myelement')?>

{% endhighlight %}

The Rails alternative would be slightly less verbose but much the same

{% highlight ruby %}
  <%= render 'myelement' %>
{% endhighlight %}

h3. Have a controller respond with JSON

Nothing major, but it took me a few minutes to figure this one out.

{% highlight php %}
  <?php echo $this->render(array('json' => $some_response)) ?>
{% endhighlight %}

h3. Validations

The model validations aren't quite as nice as they are in Rails, but they do the trick.
Here's a sample, and check out the "Validations":http://lithify.me/docs/manual/working-with-data/validation.wiki  section in the manual for more information.

{% highlight php %}

class MyModel extends \lithium\data\Model {

  public $validates = array(
    'attribute' => array(
      array(
        'notEmpty',
        'message' => 'Attribute cannot be empty'
      ), array(
        'inRange',
        'lower' => 0, 
        'upper' => 5,
        'message' => 'Attribute must be within 1 and 4'
      )
    )
  );

  //... rest of class def...
}

{% endhighlight %}

p. 
The only pain in the arse with the inRange validator is that it is not inclusive, so your lower 
value must be 1 below the lowest valid value, and the upper must be 1 higher. In the above example, 
valid values are 1,2,3, and 4. Just took a failing unit test to cop that one.

h3. Model associations

When you are using a relational datastore, then you can make use of model relationship helpers.
These do not work in MongoDB or other NoSQL stores.

{% highlight php %}

class MyModel extends \lithium\data\Model {
  public $hasOne = array('Account');
  public $belongsTo = array('User');
  public $hasMany = array('Friends');
}
  
{% endhighlight %}

p. I'll add some more to the list of miscellaneous Lithium bits and bobs when I get a chance.
